function loginService(){var t={model:{name:"11111",password:""}};return t.userIsLogged=!1,t.userLogin=function(){return t.userIsLogged=!t.userIsLogged,t},t.logOut=function(){t.loginState=!1,t.userInfo={}},t}function giphyAPIService(t,e){var o="d46f6be86154419dab1d59f376974885",r="http://api.giphy.com/v1/gifs",i=this;i.getGifs=function(i,n,s,a){var g=a.length>0?"&"+a.toString().replace(/,/g,"&"):"";return e.get(r+"/"+i+"?api_key="+o+"&"+n+"&offset="+s+g).then(function(t){return t.data.data}).catch(function(e){t.error("Error. \n"+angular.toJson(e.data,!0))})},i.getGifsById=function(r){return e.get("http://api.giphy.com/v1/gifs?api_key="+o+"&ids="+r).then(function(t){return t.data.data}).catch(function(e){t.error("Error. \n"+angular.toJson(e.data,!0))})}}function localStorageService(t){var e=this;e.init=function(){t.userInfo&&void 0!==t.userInfo?(e.loginState=!0,e.user=JSON.parse(t.userInfo)):e.loginState=!1,void 0!==t.IDstorage?e.IDstorage=JSON.parse(t.IDstorage):e.IDstorage=[]},e.addToLs=function(o){e.IDstorage.push(o),t.IDstorage=JSON.stringify(e.IDstorage)},e.removeFromLs=function(o){for(var r=0;r<e.IDstorage.length;r++)e.IDstorage[r]===o&&(e.IDstorage.splice(r,1),t.IDstorage=JSON.stringify(e.IDstorage))},e.logOut=function(){e.loginState=!1,t.userInfo=""}}function loginCtrl(t,e,o){var r=this;t.init(),e.userInfo&&void 0!==e.userInfo?(r.loginState=!0,r.userInfo=JSON.parse(e.userInfo)):(r.loginState=!1,r.userInfo={}),r.login=function(o,i){r.userInfo={name:o,password:i},e.userInfo=JSON.stringify(r.userInfo),r.loginState=!0,t.init()},o.$watch(function(){return e.userInfo},function(e,o){t.init(),r.loginState=t.loginState,r.userInfo=t.user})}function gifCtrl(t,e,o,r){var i=this;if(i.list=[],i.searchStr="",i.loadProcess=!1,i.loginState=o.loginState,i.favorites=[],i.user=o.user,o.IDstorage){var n=o.IDstorage;e.getGifsById(n.join(",")).then(function(t){i.favorites=t})}e.getGifs("trending",25,0,[]).then(function(t){i.list=t;for(var e=0;e<i.favorites.length;e++)for(var o=0;o<i.list.length;o++)i.favorites[e].id===i.list[o].id&&i.list.splice(o,1)}),i.addToFavorites=function(t){for(var e,r=0;r<i.list.length;r++)t===i.list[r].id&&(e=i.list[r],i.list.splice(r,1));i.favorites.push(e),o.addToLs(e.id)},i.removeFromFavorites=function(t){for(var e=0;e<i.favorites.length;e++)if(t===i.favorites[e].id){var r=i.favorites[e];o.removeFromLs(r.id),i.list.push(r),i.favorites.splice(e,1)}o.removeFromLs(r.id)},i.searchGif=function(){i.list=[],i.loadProcess=!0;var t="q="+i.searchStr.split(" ").join("+");e.getGifs("search",25,0,t).then(function(t){i.list=t,i.loadProcess=!1})},i.logOut=function(){o.logOut()},t.$watch(function(){return r.userInfo},function(t,e){o.init(),i.loginState=o.loginState,i.user=o.user})}angular.module("testApp",["ngStorage"]),angular.module("testApp").factory("loginService",loginService),angular.module("testApp").service("giphyAPIService",giphyAPIService),angular.module("testApp").service("localStorageService",localStorageService),angular.module("testApp").controller("loginCtrl",["localStorageService","$localStorage","$scope",loginCtrl]),angular.module("testApp").controller("gifCtrl",["$scope","giphyAPIService","localStorageService","$localStorage",gifCtrl]);
